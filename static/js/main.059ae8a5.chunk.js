(this.webpackJsonplog0107=this.webpackJsonplog0107||[]).push([[0],{142:function(e,t,n){e.exports=n(264)},147:function(e,t,n){},148:function(e,t,n){var a={"./alia.js":149,"./index.js":64,"./log.js":265,"./logCommentCreate.js":266,"./logCreate.js":267,"./logDetail.js":263};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=148},149:function(e,t,n){"use strict";n.r(t),n.d(t,"component",(function(){return a})),n.d(t,"path",(function(){return o}));var a=function(){return null},o="/alia/:text"},15:function(e,t,n){"use strict";var a=new(n(94).a)("EfficientDatabase");a.version(1).stores({logs:"++id, content, time"}),a.version(2).stores({logComments:"++id, content, time, lid"}),a.version(3).stores({textToIdMap:"++id, &text, id"}),t.a=a,window.db=a},22:function(e,t,n){e.exports={comments:"logComments_comments__1LjH6",comment:"logComments_comment__GP3sS",hoverVisible:"logComments_hoverVisible__3EWGe",commentTime:"logComments_commentTime__3ccqY",commentMeta:"logComments_commentMeta__2p6gN",commentMetaItem:"logComments_commentMetaItem__2-ZM7"}},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(){return!1}},263:function(e,t,n){"use strict";n.r(t);var a=n(19),o=n.n(a),r=n(30),c=n(9),i=n(0),l=n.n(i),u=n(26),m=n(41),s=n(8),d=n(1),f=n(44),v=n.n(f),E=n(32),g=n(36),_=n(37),p=n(22),h=n.n(p),b=n(21),O=n.n(b),C=n(35),j=n(51),N=n(31),k=n(43);function w(e){var t=Object(u.e)(),n=e.comment,a=e.id,o=Object(i.useState)(!0),r=Object(c.a)(o,2),s=r[0],f=r[1],v=Object(i.useState)(!1),E=Object(c.a)(v,2),g=E[0],p=E[1];return s&&l.a.createElement("div",{className:h.a.comment,key:n.id},l.a.createElement(m.a,{cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a\u5220\u9664",icon:"trash",intent:C.a.DANGER,isOpen:g,onCancel:function(){return p(!1)},onConfirm:function(){p(!1),_.a.del(n.id).then((function(){f(!1),N.a.show({timeout:2e3,message:"\u5220\u9664\u6210\u529f",intent:"success"})})).catch((function(e){alert(e.message)}))}},"\u4f60\u786e\u5b9a\u5c06\u6b64\u6761\u8bb0\u5f55\u5220\u9664\u5417\uff1f \u5220\u9664\u540e\u65e0\u6cd5\u518d\u6b21\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u64cd\u4f5c\u3002"),l.a.createElement("div",{className:O()(d.a.TEXT_MUTED,h.a.commentMeta)},l.a.createElement("div",{className:h.a.commentMetaBlock},l.a.createElement("span",{className:h.a.commentMetaItem},l.a.createElement(j.a,{datetime:n.time,locale:"zh_CN"}))),l.a.createElement("div",{className:O()(h.a.commentMetaBlock,h.a.hoverVisible)},l.a.createElement("a",{className:O()(h.a.commentMetaItem,d.a.TEXT_MUTED,d.a.TEXT_SMALL),onClick:function(){return t.push("/log.comment.createOrEdit/".concat(a,"/").concat(n.id))}},"\u4fee\u6539"),l.a.createElement("a",{className:O()(h.a.commentMetaItem,d.a.TEXT_MUTED,d.a.TEXT_SMALL),onClick:function(){return p(!0)}},"\u5220\u9664"))),l.a.createElement("div",{className:O()(h.a.commentContent,d.a.RUNNING_TEXT)},l.a.createElement(k.a,{source:n.content})))}function x(e){return l.a.createElement("div",{className:h.a.comments},e.list&&e.list.map((function(t){return l.a.createElement(w,{key:t.id,comment:t,id:e.id})})))}var y=/(\d+):(\d+)-(\d+):(\d+)/;function B(e,t){var n=e.split("\n"),a=function(e){var t=y.exec(e);return t?{startLine:Number(t[1]),startIndex:Number(t[2]),endLine:Number(t[3]),endIndex:Number(t[4])}:null}(t);return{from:n.slice(0,a.startLine-1).map((function(e){return e.length})).reduce((function(e,t){return e+t}),0)+(a.startLine-1)+a.startIndex,to:n.slice(0,a.endLine-1).map((function(e){return e.length})).reduce((function(e,t){return e+t}),0)+(a.endLine-1)+a.endIndex}}var T=n(70),S=n.n(T),D=n(25),I=function(e){var t=e.value,n=void 0===t?"":t,a=e.onChange,o=void 0===a?D.a:a,r=e.placeholder,c=void 0===r?"":r;return l.a.createElement("div",{className:S.a.container},l.a.createElement("div",{className:S.a.editorBox},l.a.createElement(m.l,{fill:!0,large:!0,value:n,growVertically:!0,placeholder:c,onChange:function(e){return o(e.target.value)}})))},L=n(33);function M(e){var t=e.isOpen,n=void 0!==t&&t,a=e.onClose,o=void 0===a?D.a:a,r=e.value,c=void 0===r?"":r,i=e.onChange,u=void 0===i?D.a:i,f=e.onConfirm,v=void 0===f?D.a:f;return l.a.createElement(m.d,{icon:"annotation",autoFocus:!0,hasBackdrop:!0,isOpen:n,position:s.a.BOTTOM,size:m.d.SIZE_LARGE,onClose:o,onConfirm:v},l.a.createElement("div",{className:d.a.DRAWER_BODY},l.a.createElement("div",{style:{backgroundColor:"#ebf1f5",height:"100%"}},l.a.createElement("div",{className:d.a.DIALOG_HEADER},l.a.createElement("div",{style:{display:"flex",width:640,margin:"auto",alignItems:"center"}},l.a.createElement(m.f,{icon:"annotation"}),l.a.createElement(m.e,null,"\u5c40\u90e8\u7f16\u8f91"),l.a.createElement(m.b,{minimal:!0,icon:"confirm",intent:"primary",className:d.a.DIALOG_CLOSE_BUTTON,onClick:v},"\u63d0\u4ea4"))),l.a.createElement("div",{className:d.a.DIALOG_BODY},l.a.createElement(I,{value:c,onChange:function(e){return u(e)}})))))}n.d(t,"component",(function(){return G})),n.d(t,"path",(function(){return F}));var A=function(e){var t=Object(u.e)(),n=Object(u.f)();return l.a.createElement(l.a.Fragment,null,l.a.createElement(m.b,{icon:"comment",minimal:!0,onClick:function(){return t.push("/log.comment.createOrEdit/".concat(n.id))}},"\u8bc4\u8bba"),l.a.createElement(m.h,null),l.a.createElement(m.b,{icon:"annotation",minimal:!0,onClick:function(){return t.push("/log.createOrEdit/".concat(n.id))}},"\u4fee\u6539"),e.children,l.a.createElement(m.h,null),l.a.createElement(m.b,{icon:"delete",intent:"danger",minimal:!0,onClick:function(){window.confirm("\u786e\u8ba4\u5220\u9664\uff1f")&&g.a.del(n.id).then((function(){N.a.show({timeout:2e3,message:"\u5220\u9664\u6210\u529f",intent:"success"}),t.goBack()})).catch((function(e){alert(e.message)}))}},"\u5220\u9664"))};var G=function(e){var t=Object(u.f)(),n=Object(i.useState)(!1),a=Object(c.a)(n,2),s=a[0],d=a[1],f=Object(i.useState)(null),p=Object(c.a)(f,2),h=p[0],b=p[1],O=Object(i.useState)([]),C=Object(c.a)(O,2),j=C[0],N=C[1],w=Object(i.useState)(!1),y=Object(c.a)(w,2),T=y[0],S=y[1],D=Object(i.useState)(!1),I=Object(c.a)(D,2),G=I[0],F=I[1],H=Object(i.useState)(""),U=Object(c.a)(H,2),W=U[0],X=U[1],R=Object(i.useState)(null),V=Object(c.a)(R,2),P=V[0],z=V[1];return Object(i.useEffect)((function(){function e(){return(e=Object(r.a)(o.a.mark((function e(){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get(t.id);case 2:return n=e.sent,e.next=5,_.a.all(t.id);case 5:a=e.sent,b(n),N(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.id,s]),l.a.createElement(E.a,{header:l.a.createElement(L.a,{showBack:!0,title:"\u82f1\u96c4\xb7\u65e5\u5fd7\u8be6\u60c5",actions:l.a.createElement(A,null,l.a.createElement(m.k,{style:{marginBottom:0,marginLeft:5,marginRight:5},label:"\u5c40\u90e8\u4fee\u6539",checked:T,onChange:function(){return S(!T)}}))})},l.a.createElement("div",{className:v.a.container},h&&l.a.createElement("div",{className:v.a.logContentBox},l.a.createElement("div",{className:v.a.logContent},l.a.createElement(k.a,{source:h.content,selectAble:T,onSelect:function(e){var t=function(e,t){var n=B(e,t);return e.slice(n.from-1,n.to-1)}(h.content,e);F(!0),X(t),z(e)}}))),l.a.createElement("div",{className:v.a.commentBox},l.a.createElement("div",{className:v.a.commentContent},l.a.createElement(x,{list:j,id:t.id})))),l.a.createElement(M,{isOpen:G,onClose:function(){F(!1)},onConfirm:function(){F(!1);var e=function(e,t,n){var a=B(e,t);return e.slice(0,a.from-1)+n+e.slice(a.to-1)}(h.content,P,W);g.a.upd(h.id,{content:e}).then((function(){return d(!s)}))},value:W,onChange:function(e){return X(e)}}))},F="/log.detail/:id"},264:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(14),c=n.n(r),i=(n(147),n(24)),l=n(64);n(259),n(260),n(261),n(262);var u=function(){return o.a.createElement(i.a,null,l.default)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(u,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},265:function(e,t,n){"use strict";n.r(t);var a=n(19),o=n.n(a),r=n(30),c=n(9),i=n(0),l=n.n(i),u=n(26),m=n(41),s=n(89),d=n.n(s),f=n(51),v=n(35),E=n(1),g=n(34),_=n(21),p=n.n(_),h=n(52),b=n.n(h),O=n(43),C=n(31),j=n(36),N=function(e){var t=Object(u.e)(),n=Object(i.useState)(!0),a=Object(c.a)(n,2),o=a[0],r=a[1],s=Object(i.useState)(!1),d=Object(c.a)(s,2),_=d[0],h=d[1];return o&&l.a.createElement("div",{className:b.a.container},l.a.createElement(m.a,{cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a\u5220\u9664",icon:"trash",intent:v.a.DANGER,isOpen:_,onCancel:function(){return h(!1)},onConfirm:function(){h(!1),j.a.del(e.id).then((function(){r(!1),C.a.show({timeout:2e3,message:"\u5220\u9664\u6210\u529f",intent:"success"})})).catch((function(e){alert(e.message)}))}},"\u4f60\u786e\u5b9a\u5c06\u6b64\u6761\u8bb0\u5f55\u5220\u9664\u5417\uff1f \u5220\u9664\u540e\u65e0\u6cd5\u518d\u6b21\u627e\u56de\uff0c\u8bf7\u786e\u8ba4\u64cd\u4f5c\u3002"),l.a.createElement("div",{className:b.a.meta},l.a.createElement("span",{className:p()(E.a.TEXT_MUTED,E.a.TEXT_SMALL)},l.a.createElement(f.a,{datetime:e.date,locale:"zh_CN"}))),l.a.createElement(m.c,{elevation:g.a.ONE,interactive:!0,onClick:function(){return t.push("/log.detail/".concat(e.id))}},l.a.createElement("div",{className:p()("markdown-body",b.a.markdownBody)},l.a.createElement(O.a,{source:e.children,short:!0}))))},k=n(32),w=n(33);n.d(t,"component",(function(){return x})),n.d(t,"path",(function(){return y})),n.d(t,"exact",(function(){return B}));var x=function(){var e=Object(u.e)(),t=Object(i.useState)([]),n=Object(c.a)(t,2),a=n[0],s=n[1];return Object(i.useEffect)((function(){function e(){return(e=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.all();case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),l.a.createElement(k.a,{header:l.a.createElement(w.a,{title:"\u82f1\u96c4\xb7\u65e5\u5fd7",actions:l.a.createElement(m.b,{minimal:!0,intent:"primary",icon:"annotation",onClick:function(){return e.push("/log.createOrEdit")}},"\u521b\u5efa\u65e5\u5fd7")})},l.a.createElement("div",{className:d.a.container},a.map((function(e){return l.a.createElement(N,{key:e.id,id:e.id,date:e.time},e.content)}))))},y="/log",B=!0},266:function(e,t,n){"use strict";n.r(t);var a=n(19),o=n.n(a),r=n(30),c=n(9),i=n(0),l=n.n(i),u=n(26),m=n(41),s=n(96),d=n.n(s),f=n(97),v=n.n(f),E=n(25);function g(e){var t=e.value,n=void 0===t?"":t,a=e.onChange,o=void 0===a?E.a:a,r=e.placeholder,c=void 0===r?"":r;return l.a.createElement("div",{className:v.a.container},l.a.createElement(m.c,null,l.a.createElement(m.l,{fill:!0,large:!0,value:n,growVertically:!0,placeholder:c,onChange:function(e){return o(e.target.value)}})))}var _=n(32),p=n(33),h=n(37);n.d(t,"component",(function(){return b})),n.d(t,"path",(function(){return O}));var b=function(){var e=Object(u.f)(),t=e.id,n=void 0===t?null:t,a=e.cid,s=void 0===a?null:a,f=Object(i.useState)(!1),v=Object(c.a)(f,2),E=v[0],b=v[1],O=Object(i.useState)(!0),C=Object(c.a)(O,2),j=C[0],N=C[1],k=Object(i.useState)(""),w=Object(c.a)(k,2),x=w[0],y=w[1],B=Object(u.e)();return Object(i.useEffect)((function(){Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=3;break}return b(!0),e.abrupt("return");case 3:h.a.get(s).then((function(e){e&&y(e.content),N(!1)})).finally((function(){b(!0)}));case 5:case"end":return e.stop()}}),e)})))()}),[s]),l.a.createElement(_.a,{header:l.a.createElement(p.a,{showBack:!0,title:"\u7f16\u8f91\u65e5\u5fd7\u8bc4\u8bba",actions:l.a.createElement(m.b,{minimal:!0,icon:"confirm",intent:"primary",onClick:function(){(j?h.a.add(n,{time:new Date,content:x}):h.a.upd(s,{content:x})).then((function(){B.goBack()})).catch((function(e){alert(e.message)}))}},"\u63d0\u4ea4")})},l.a.createElement("div",{className:d.a.container},E&&l.a.createElement(g,{value:x,onChange:function(e){return y(e)},placeholder:"\u8bf7\u4ece\u6b64\u51fa\u5f00\u59cb..."})))},O="/log.comment.createOrEdit/:id/:cid?"},267:function(e,t,n){"use strict";n.r(t);var a=n(19),o=n.n(a),r=n(30),c=n(9),i=n(0),l=n.n(i),u=n(26),m=n(41),s=n(98),d=n.n(s),f=n(99),v=n.n(f),E=n(25);function g(e){var t=e.value,n=void 0===t?"":t,a=e.onChange,o=void 0===a?E.a:a,r=e.placeholder,c=void 0===r?"":r;return l.a.createElement("div",{className:v.a.container},l.a.createElement(m.c,null,l.a.createElement(m.l,{fill:!0,large:!0,value:n,growVertically:!0,placeholder:c,onChange:function(e){return o(e.target.value)}})))}var _=n(32),p=n(33),h=n(15),b=n(31);n.d(t,"component",(function(){return O})),n.d(t,"path",(function(){return C}));var O=function(){var e=Object(u.e)(),t=Object(u.f)().id,n=void 0===t?null:t,a=Object(i.useState)(!1),s=Object(c.a)(a,2),f=s[0],v=s[1],E=Object(i.useState)(!0),O=Object(c.a)(E,2),C=O[0],j=O[1],N=Object(i.useState)(""),k=Object(c.a)(N,2),w=k[0],x=k[1];return Object(i.useEffect)((function(){Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return v(!0),e.abrupt("return");case 3:h.a.logs.get(Number(n)).then((function(e){e&&x(e.content),j(!1)})).finally((function(){v(!0)}));case 5:case"end":return e.stop()}}),e)})))()}),[n]),l.a.createElement(_.a,{header:l.a.createElement(p.a,{showBack:!0,title:"\u7f16\u8f91\u65e5\u5fd7",actions:l.a.createElement(m.b,{minimal:!0,intent:"primary",icon:"confirm",onClick:function(){(C?h.a.logs.add({time:new Date,content:w}):h.a.logs.update(Number(n),{content:w})).then((function(){e.goBack()})).catch((function(e){b.a.show({timeout:2e3,message:e.message,intent:"error"})}))}},"\u63d0\u4ea4")})},l.a.createElement("div",{className:d.a.container},f&&l.a.createElement(g,{value:w,onChange:function(e){return x(e)},placeholder:"\u8bf7\u7531\u6b64\u5f00\u59cb..."})))},C="/log.createOrEdit/:id?"},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(41),o=n(8),r=a.m.create({className:"recipe-toaster",position:o.a.TOP})},32:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(46),c=n.n(r);t.a=function(e){return o.a.createElement("div",{className:c.a.container},e.header&&o.a.createElement("div",{className:c.a.header},e.header),o.a.createElement("div",{className:c.a.body},e.children),e.footer&&o.a.createElement("div",{className:c.a.footer},e.footer))}},33:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0),o=n.n(a),r=n(26),c=n(41);function i(e){var t=e.showBack,n=void 0!==t&&t,a=e.title,i=void 0===a?"":a,l=e.actions,u=void 0===l?[]:l,m=Object(r.e)();return o.a.createElement(c.g,{style:{userSelect:"none"}},o.a.createElement("div",{style:{width:"640px",margin:"auto"}},o.a.createElement(c.i,{align:"left"},n&&o.a.createElement(o.a.Fragment,null,o.a.createElement(c.b,{onClick:function(){return m.goBack()},icon:"chevron-left",minimal:!0},"\u8fd4\u56de"),o.a.createElement(c.h,null)),""!==i&&o.a.createElement(c.j,null,i)),o.a.createElement(c.i,{align:"right"},u)))}},36:function(e,t,n){"use strict";var a=n(15);t.a={get:function(e){return a.a.logs.get(Number(e))},add:function(e){return a.a.logs.add(e)},del:function(e){return a.a.logs.delete(Number(e))},upd:function(e,t){return a.a.logs.update(Number(e),t)},all:function(){return a.a.logs.orderBy("time").toArray().then((function(e){return e.reverse()}))}}},37:function(e,t,n){"use strict";var a=n(100),o=n(15);t.a={get:function(e){return o.a.logComments.get(Number(e))},add:function(e,t){return o.a.logComments.add(Object(a.a)({},t,{lid:e}))},del:function(e){return o.a.logComments.delete(Number(e))},upd:function(e,t){return o.a.logComments.update(Number(e),t)},all:function(e){return o.a.logComments.where({lid:e}).toArray()}}},43:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(0),o=n.n(a),r=n(90),c=n.n(r),i=n(21),l=n.n(i),u=n(53),m=n.n(u);function s(e){var t=e.source,n=void 0===t?"":t,a=e.className,r=e.selectAble,i=void 0!==r&&r,u=n.indexOf("---\n"),s=u>0?n.slice(0,u):"";return o.a.createElement("div",{className:l()("markdown-body",a,m.a.markdownBody,i?m.a.active:""),onClick:function(t){if(e.selectAble&&"function"===typeof e.onSelect){var n=function e(t){if(!(t instanceof HTMLElement))return null;if(!(t.parentNode instanceof HTMLElement))return null;var n=t.parentElement;return n.classList.contains(m.a.markdownBody)?t:e(n)}(t.target).getAttribute("data-sourcePos");e.onSelect(n)}}},o.a.createElement(c.a,{source:e.short&&s||n,sourcePos:i}))}},44:function(e,t,n){e.exports={container:"logDetail_container__w0WFV",logContentBox:"logDetail_logContentBox__2FBOS",logContent:"logDetail_logContent__2q741",commentBox:"logDetail_commentBox__2xmER",commentContent:"logDetail_commentContent__2yOe-"}},46:function(e,t,n){e.exports={container:"appFrame_container__28Uto",header:"appFrame_header__VXnlL",body:"appFrame_body__1wP9K",footer:"appFrame_footer__PUQHy"}},52:function(e,t,n){e.exports={container:"logItem_container__1HQ_G",metaBlock:"logItem_metaBlock__19X2m",meta:"logItem_meta__JAOjF",metaItem:"logItem_metaItem__37psE",markdownBody:"logItem_markdownBody__1O-pH"}},53:function(e,t,n){e.exports={markdownBody:"markdownPreview_markdownBody__3D-P7"}},64:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(26),c=[],i=n(148);i.keys().forEach((function(e){if("./index.js"!==e){var t=i(e);c.push(o.a.createElement(r.a,Object.assign({},t,{key:e})))}})),t.default=c},70:function(e,t,n){e.exports={container:"markdownEditor_container__1Bh7Q",editorBox:"markdownEditor_editorBox__2jfkZ"}},89:function(e,t,n){e.exports={container:"log_container__1snyH"}},96:function(e,t,n){e.exports={container:"logCommentCreate_container__3qGs1"}},97:function(e,t,n){e.exports={textarea:"logCommentEditor_textarea__ltzcQ",container:"logCommentEditor_container__3s0iH",buttonWrap:"logCommentEditor_buttonWrap__o5tot"}},98:function(e,t,n){e.exports={container:"logCreate_container__19vSt"}},99:function(e,t,n){e.exports={textarea:"logEditor_textarea__28vya",container:"logEditor_container__1GeHV",buttonWrap:"logEditor_buttonWrap__1W5No"}}},[[142,1,2]]]);
//# sourceMappingURL=main.059ae8a5.chunk.js.map