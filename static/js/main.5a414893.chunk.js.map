{"version":3,"sources":["page/logCreate.module.css","component/logEditor/index.module.css","page sync nonrecursive //.js$","service/log.js","store/index.js","component/logComments/index.module.css","component/logComments/index.js","util/sourcePosUtil.js","component/markdownEditor/index.js","page/logDetail.js","App.js","serviceWorker.js","index.js","service/textToIdMap.js","page/alia.js","component/logEditor/index.js","page/logCreate.js","component/logCommentEditor/index.js","page/logCommentCreate.js","component/logItem/index.js","page/log.js","component/appFrame/index.js","component/normalNavigator/index.js","util/toaster.js","util/commonUtil.js","service/logComment.js","component/markdownPreview/index.js","page/logDetail.module.css","component/appFrame/index.module.css","component/logItem/index.module.css","component/markdownPreview/index.module.css","page/index.js","component/markdownEditor/index.module.css","page/alia.module.css","page/log.module.css","page/logCommentCreate.module.css","component/logCommentEditor/index.module.css"],"names":["module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","get","store","logs","Number","add","logInfo","time","Date","del","delete","upd","update","all","orderBy","toArray","then","l","reverse","db","Dexie","version","stores","logComments","textToIdMap","window","LogComment","props","h","useHistory","c","comment","useState","visible","setVisible","isOpen","setIsOpen","className","styles","key","cancelButtonText","confirmButtonText","icon","intent","Intent","DANGER","onCancel","onConfirm","logCommentService","AppToaster","show","timeout","message","catch","err","alert","names","Classes","TEXT_MUTED","commentMeta","commentMetaBlock","commentMetaItem","datetime","locale","hoverVisible","TEXT_SMALL","onClick","push","commentContent","RUNNING_TEXT","source","content","LogComments","comments","list","REG","getRange","sourcePosStr","sourceArr","split","sourcePos","match","exec","startLine","startIndex","endLine","endIndex","sourcePosParse","from","slice","length","reduce","p","n","to","value","onChange","noop","placeholder","container","editorBox","fill","large","autoFocus","growVertically","evt","target","PartialEditDrawer","onClose","hasBackdrop","position","Position","BOTTOM","size","Drawer","SIZE_LARGE","DRAWER_BODY","style","backgroundColor","height","DIALOG_HEADER","display","width","margin","alignItems","minimal","DIALOG_CLOSE_BUTTON","DIALOG_BODY","val","NavigationActions","params","useParams","children","confirm","logService","goBack","component","flag","setFlag","logData","setLogData","logCommentsData","setLogCommentsData","partialEdit","setPartialEdit","isOpenPartialEditDrawer","setIsOpenPartialEditDrawer","partialSource","setPartialSource","posData","setPosData","useEffect","a","logCommentsInfo","fetchData","header","showBack","title","actions","marginBottom","marginLeft","marginRight","label","checked","logContentBox","logContent","selectAble","onSelect","pos","partial","range","sliceCodeFromSource","commentBox","replacement","replaceCodeFromSource","path","App","pages","Boolean","location","hostname","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","text","where","first","lid","createAndLink","success","textToIdMapService","isValidText","isTextExist","setIsTextExist","isTextExistInit","setIsTextExistInit","isLogExist","setIsLogExist","isLogExistInit","setIsLogExistInit","isInit","log","replace","validate","description","action","LogEditor","initState","setInitState","isNew","setIsNew","setValue","m","finally","LogCommentEditor","cid","meta","date","elevation","Elevation","ONE","interactive","markdownBody","short","setlogs","fetch","exact","body","footer","NormalNavigator","userSelect","align","Toaster","create","TOP","logCommentInfo","MarkdownPreview","rsource","_","p1","generatLinks","sepIdx","indexOf","active","findTopLevelEle","HTMLElement","parentNode","pnode","parentElement","classList","contains","getAttribute","routes","pageCtx","require","forEach","route"],"mappings":"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","file":"static/js/main.5a414893.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"logCreate_container__19vSt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textarea\":\"logEditor_textarea__28vya\",\"container\":\"logEditor_container__1GeHV\",\"buttonWrap\":\"logEditor_buttonWrap__1W5No\"};","var map = {\n\t\"./alia.js\": 262,\n\t\"./index.js\": 65,\n\t\"./log.js\": 265,\n\t\"./logCommentCreate.js\": 264,\n\t\"./logCreate.js\": 263,\n\t\"./logDetail.js\": 260\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 146;","import store from 'store/index';\n\nconst get = (id) => store.logs.get(Number(id));\n\nconst add = (logInfo) => store.logs.add({...logInfo, time: new Date()});\n\nconst del = (id) => store.logs.delete(Number(id));\n\nconst upd = (id, logInfo) => store.logs.update(Number(id), logInfo);\n\nconst all = () => store.logs.orderBy('time').toArray().then(l => l.reverse());\n\nexport default {\n    get, add, del, upd, all\n}","import Dexie from 'dexie';\n\nconst db = new Dexie('EfficientDatabase');\n\ndb.version(1).stores({\n    logs: '++id, content, time'\n});\n\ndb.version(2).stores({\n    logComments: '++id, content, time, lid'\n});\n\ndb.version(3).stores({\n    textToIdMap: '++id, &text, lid'\n});\n\nexport default db;\nwindow.db = db;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"comments\":\"logComments_comments__1LjH6\",\"comment\":\"logComments_comment__GP3sS\",\"hoverVisible\":\"logComments_hoverVisible__3EWGe\",\"commentTime\":\"logComments_commentTime__3ccqY\",\"commentMeta\":\"logComments_commentMeta__2p6gN\",\"commentMetaItem\":\"logComments_commentMetaItem__2-ZM7\"};","/* eslint-disable jsx-a11y/anchor-is-valid  */\n\nimport React, { useState } from 'react';\nimport styles from './index.module.css';\nimport names from 'classnames';\nimport { Classes, Alert, Intent } from '@blueprintjs/core';\nimport TimeAgo from 'timeago-react';\nimport { useHistory } from 'react-router-dom';\nimport { AppToaster } from 'util/toaster';\nimport logCommentService from 'service/logComment';\nimport MarkdownPreview from 'component/markdownPreview';\n\nfunction LogComment(props) {\n    const h = useHistory();\n    const { comment: c, id } = props;\n    const [ visible, setVisible ] = useState(true);\n    const [ isOpen, setIsOpen ] = useState(false);\n    return (\n        visible && <div className={styles.comment} key={c.id}>\n            <Alert\n                cancelButtonText=\"取消\"\n                confirmButtonText=\"确定删除\"\n                icon=\"trash\"\n                intent={Intent.DANGER}\n                isOpen={isOpen}\n                onCancel={() => setIsOpen(false)}\n                onConfirm={() => {\n                    setIsOpen(false);\n                    logCommentService.del(c.id)\n                        .then(() => {\n                            setVisible(false);\n                            AppToaster.show({ timeout: 2000, message: '删除成功', intent: 'success' });\n                        })\n                        .catch(err => {\n                            alert(err.message);\n                        });\n                }}\n            >\n                你确定将此条记录删除吗？ 删除后无法再次找回，请确认操作。\n            </Alert>\n            <div className={names(Classes.TEXT_MUTED, styles.commentMeta)}>\n                <div className={styles.commentMetaBlock}>\n                    <span className={styles.commentMetaItem}><TimeAgo datetime={c.time} locale='zh_CN' /></span>\n                </div>\n                <div className={names(styles.commentMetaBlock, styles.hoverVisible)}>\n                    <a\n                        className={names(\n                            styles.commentMetaItem,\n                            Classes.TEXT_MUTED,\n                            Classes.TEXT_SMALL\n                        )}\n                        onClick={() => h.push(`/log.comment.createOrEdit/${id}/${c.id}`)}\n                    >\n                        修改\n                    </a>\n                    <a\n                        className={names(\n                            styles.commentMetaItem,\n                            Classes.TEXT_MUTED,\n                            Classes.TEXT_SMALL\n                        )}\n                        onClick={() => setIsOpen(true) }\n                    >\n                        删除\n                    </a>\n                </div>\n            </div>\n            <div className={names(styles.commentContent, Classes.RUNNING_TEXT)}>\n                <MarkdownPreview source={c.content} />\n            </div>\n        </div>\n    );\n}\n\nexport default function LogComments(props) {\n    return (\n        <div className={styles.comments}>\n            {\n                props.list && props.list.map(c => (\n                    <LogComment key={c.id} comment={c} id={props.id} />\n                ))\n            }\n        </div>\n    );\n}","\nconst REG = /(\\d+):(\\d+)-(\\d+):(\\d+)/;\n\nexport function sourcePosParse(sourcePosStr) {\n    const match = REG.exec(sourcePosStr);\n    if (!match) return null;\n    return {\n        startLine: Number(match[1]),\n        startIndex: Number(match[2]),\n        endLine: Number(match[3]),\n        endIndex: Number(match[4]),\n    }\n}\n\nexport function getRange(source, sourcePosStr) {\n    const sourceArr = source.split('\\n');\n    const sourcePos = sourcePosParse(sourcePosStr);\n    const range = {\n        from: sourceArr\n            .slice(0, sourcePos.startLine - 1)\n            .map(l => l.length)\n            .reduce((p, n) => p + n, 0) + (sourcePos.startLine - 1) + sourcePos.startIndex,\n        to: sourceArr\n            .slice(0, sourcePos.endLine - 1)\n            .map(l => l.length)\n            .reduce((p, n) => p + n, 0) + (sourcePos.endLine - 1) + sourcePos.endIndex,\n    };\n    return range;\n}\n\nexport function sliceCodeFromSource(source, sourcePosStr) {\n    const range = getRange(source, sourcePosStr);\n    return source.slice(range.from - 1, range.to - 1);\n}\nexport function replaceCodeFromSource(source, sourcePosStr, replacement) {\n    const range = getRange(source, sourcePosStr);\n    return source.slice(0, range.from - 1) + replacement + source.slice(range.to - 1);\n}","import React from 'react';\nimport styles from './index.module.css';\nimport { TextArea } from '@blueprintjs/core';\nimport { noop } from 'util/commonUtil';\n\nexport default function(props) {\n    const {\n        value = '',\n        onChange = noop,\n        placeholder = ''\n    } = props;\n    return (\n        <div className={styles.container}>\n            <div className={styles.editorBox}>\n                <TextArea\n                    fill large\n                    autoFocus\n                    value={value}\n                    growVertically\n                    placeholder={placeholder}\n                    onChange={evt => onChange(evt.target.value)}\n                />\n            </div>\n        </div>\n    );\n}","import React, { useEffect, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport {\n    Button, Classes, Switch, Drawer, Position, Icon, NavbarDivider, H5\n} from '@blueprintjs/core';\nimport styles from './logDetail.module.css';\nimport AppFrame from 'component/appFrame';\nimport logService from 'service/log';\nimport logCommentService from 'service/logComment';\nimport LogComments from 'component/logComments';\nimport { AppToaster } from 'util/toaster';\nimport MarkdownPreview from 'component/markdownPreview';\nimport { sliceCodeFromSource, replaceCodeFromSource } from 'util/sourcePosUtil';\nimport MarkdownEditor from 'component/markdownEditor';\nimport { noop } from 'util/commonUtil';\nimport NormalNavigator from 'component/normalNavigator';\n\nfunction PartialEditDrawer(props) {\n    const {\n        isOpen = false,\n        onClose = noop,\n        value = '',\n        onChange = noop,\n        onConfirm = noop\n    } = props;\n    return (\n        <Drawer\n            icon=\"annotation\"\n            autoFocus\n            hasBackdrop\n            isOpen={isOpen}\n            position={Position.BOTTOM}\n            size={Drawer.SIZE_LARGE}\n            onClose={onClose}\n            onConfirm={onConfirm}\n        >\n            <div className={Classes.DRAWER_BODY}>\n                <div style={{ backgroundColor: '#ebf1f5', height: '100%' }}>\n                    <div className={Classes.DIALOG_HEADER}>\n                        <div style={{\n                            display: 'flex',\n                            width: 640,\n                            margin: 'auto',\n                            alignItems: 'center'\n                        }}>\n                            <Icon icon=\"annotation\" />\n                            <H5>局部编辑</H5>\n                            <Button\n                                minimal\n                                icon=\"confirm\"\n                                intent=\"primary\"\n                                className={Classes.DIALOG_CLOSE_BUTTON}\n                                onClick={onConfirm}\n                            >\n                                提交\n                            </Button>\n                        </div>\n                    </div>\n                    <div className={Classes.DIALOG_BODY}>\n                        <MarkdownEditor\n                            value={value}\n                            onChange={val => onChange(val)}\n                        />\n                    </div>\n                </div>\n            </div>\n        </Drawer>\n    );\n}\n\nconst NavigationActions = props => {\n    const h = useHistory();\n    const params = useParams();\n    return (\n        < >\n            <Button icon=\"comment\" minimal onClick={() => h.push(`/log.comment.createOrEdit/${params.id}`)}>评论</Button>\n            <NavbarDivider />\n            <Button icon=\"annotation\" minimal onClick={() => h.push(`/log.createOrEdit/${params.id}`)}>修改</Button>\n            { props.children }\n            <NavbarDivider />\n            <Button icon=\"delete\" intent=\"danger\" minimal onClick={() => {\n                if (!window.confirm(\"确认删除？\")) return;\n                logService.del(params.id)\n                    .then(() => {\n                        AppToaster.show({ timeout: 2000, message: '删除成功', intent: 'success' });\n                        h.goBack();\n                    })\n                    .catch(err => {\n                        alert(err.message);\n                    });\n            }}>删除</Button>\n        </>\n    );\n};\n\nfunction LogDetail(props) {\n    const params = useParams();\n    const [flag, setFlag] = useState(false);\n    const [logData, setLogData] = useState(null);\n    const [logCommentsData, setLogCommentsData] = useState([]);\n    const [partialEdit, setPartialEdit] = useState(false);\n    const [isOpenPartialEditDrawer, setIsOpenPartialEditDrawer] = useState(false);\n    const [partialSource, setPartialSource] = useState('');\n    const [posData, setPosData] = useState(null);\n    useEffect(() => {\n        async function fetchData() {\n            const logInfo = await logService.get(params.id);\n            const logCommentsInfo = await logCommentService.all(params.id);\n            setLogData(logInfo);\n            setLogCommentsData(logCommentsInfo);\n        }\n        fetchData();\n    }, [params.id, flag]);\n    return (\n        <AppFrame\n            header={\n                <NormalNavigator\n                    showBack\n                    title=\"英雄·日志详情\"\n                    actions={\n                        <NavigationActions>\n                            <Switch style={{ marginBottom: 0, marginLeft: 5, marginRight: 5 }}\n                                label=\"局部修改\" checked={partialEdit} onChange={() => setPartialEdit(!partialEdit)}/>\n                        </NavigationActions>\n                    }\n                />\n            }\n        >\n            <div className={styles.container}>\n                {\n                    logData && <div className={styles.logContentBox}>\n                        <div className={styles.logContent}>\n                            <MarkdownPreview source={logData.content} selectAble={partialEdit} onSelect={\n                                pos => {\n                                    const partial = sliceCodeFromSource(logData.content, pos);\n                                    setIsOpenPartialEditDrawer(true);\n                                    setPartialSource(partial);\n                                    setPosData(pos);\n                                }\n                            } />\n                        </div>\n                    </div>\n                }\n\n                <div className={styles.commentBox}>\n                    <div className={styles.commentContent}>\n                        <LogComments list={logCommentsData} id={params.id} />\n                    </div>\n                </div>\n            </div>\n            <PartialEditDrawer\n                isOpen={isOpenPartialEditDrawer}\n                onClose={() => {\n                    setIsOpenPartialEditDrawer(false);\n                }}\n                onConfirm={() => {\n                    setIsOpenPartialEditDrawer(false);\n                    const source = replaceCodeFromSource(logData.content, posData, partialSource);\n                    logService\n                        .upd(logData.id, { content: source })\n                        .then(() => setFlag(!flag));\n                }}\n                value={partialSource}\n                onChange={val => setPartialSource(val)}\n            />\n        </AppFrame>\n    );\n}\n\nexport const component = LogDetail;\nexport const path = '/log.detail/:id';","import React from 'react';\nimport { HashRouter as Router } from 'react-router-dom';\nimport pages from './page';\nimport 'normalize.css';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\nimport 'github-markdown-css';\n\nfunction App() {\n    return (\n        <Router>{pages}</Router>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import store from 'store/index';\n\nconst findMapByText = text => store\n    .textToIdMap\n    .where({text})\n    .first(match => match)\n    .catch(() => null);\n\nconst link = (text, lid) => store.textToIdMap.add({ text, lid });\n\nexport default {\n    findMapByText,\n    link\n};","\nimport React, { useEffect, useState } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport AppFrame from 'component/appFrame';\nimport NormalNavigator from 'component/normalNavigator';\nimport logService from 'service/log';\nimport textToIdMapService from 'service/textToIdMap';\nimport styles from './alia.module.css';\nimport { Button, NonIdealState, Tag, Spinner } from '@blueprintjs/core';\nimport { AppToaster } from 'util/toaster';\n\nconst createAndLink = async (text) => {\n    let success = true;\n    let lid;\n    try {\n        lid = await logService.add({ content: text + '---\\n' });\n        await textToIdMapService.link(text, lid);\n    } catch(err) {\n        AppToaster.show({ timeout: 2000, message: err.message, intent: 'danger' });\n        success = false;\n    }\n    return success ? lid : null;\n}\n\nfunction Log() {\n    const TEXT_REG = /^\\w{1,100}$/;\n    const params = useParams();\n    const h = useHistory();\n    const { text = '' } = params;\n    const isValidText = text.match(TEXT_REG);\n    const [ isTextExist, setIsTextExist ] = useState(false);\n    const [ isTextExistInit, setIsTextExistInit ] = useState(false);\n    const [ isLogExist, setIsLogExist ] = useState(false);\n    const [ isLogExistInit, setIsLogExistInit ] = useState(false);\n    const isInit = isTextExistInit && isLogExistInit;\n\n    useEffect(() => {\n        async function validate() {\n            const map = await textToIdMapService.findMapByText(text);\n            if (map) {\n                setIsTextExist(true);\n                const log = await logService.get(map.lid);\n                if (log) {\n                    setIsLogExist(true);\n                    h.replace(`/log.detail/${log.id}`);\n                    return;\n                }\n            }\n            setIsTextExistInit(true);\n            setIsLogExistInit(true);\n        }\n        validate();\n    }, [ text, h ]);\n\n    let icon = '';\n    let description = '';\n    let action = null;\n\n    if (!isValidText) {\n        icon=\"error\";\n        description = <span><Tag minimal large >{text}</Tag> 格式不正确</span>;\n        action = null;\n    } else {\n        if (!isTextExist) {\n            icon=\"info-sign\";\n            description = <span><Tag minimal large >{text}</Tag> 尚未关联日志</span>;\n            action = <Button onClick={() => createAndLink(text).then(lid => lid && h.replace(`/log.detail/${lid}`))} intent=\"primary\" icon=\"confirm\">新建并关联</Button>;\n        } else {\n            if (!isLogExist) {\n                icon=\"warning-sign\";\n                description = <span><Tag minimal large >{text}</Tag> 对应的日志不存在</span>;\n                action = <Button onClick={() => createAndLink(text).then(lid => lid && h.replace(`/log.detail/${lid}`))} intent=\"primary\" icon=\"confirm\">新建并关联</Button>;\n            }\n        }\n    }\n\n    return (\n        <AppFrame header={\n            <NormalNavigator showBack title=\"正在检查\" />\n        }>\n            <div className={styles.container}>\n                {\n                    !isInit && <Spinner />\n                }\n                {\n                    isInit && <NonIdealState\n                        title=\"温馨提示\"\n                        description={description}\n                        icon={icon}\n                        action={action}\n                    >\n                    </NonIdealState>\n                }\n            </div>\n        </AppFrame>\n    );\n}\n\nexport const component = Log;\nexport const path = '/alia/:text';","import React from 'react';\nimport { Card, TextArea } from '@blueprintjs/core';\nimport styles from './index.module.css';\nimport { noop } from 'util/commonUtil';\n\nexport default function LogEditor(props) {\n    const { value = '', onChange = noop, placeholder = '' } = props;\n    return (\n        <div className={styles.container}>\n            <Card>\n                <TextArea\n                    fill\n                    large\n                    autoFocus\n                    value={value}\n                    growVertically\n                    placeholder={placeholder}\n                    onChange={evt => onChange(evt.target.value)}\n                />\n            </Card>\n        </div>\n    );\n}","import React, { useState, useEffect } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Button } from '@blueprintjs/core';\nimport styles from './logCreate.module.css';\nimport LogEditor from 'component/logEditor';\nimport AppFrame from 'component/appFrame';\nimport NormalNavigator from 'component/normalNavigator';\nimport logService from 'service/log';\nimport { AppToaster } from 'util/toaster';\n\nfunction LogCreate() {\n    const h = useHistory();\n    const params = useParams();\n    const { id = null } = params;\n    const [ initState, setInitState ] = useState(false);\n    const [ isNew, setIsNew ] = useState(true);\n    const [ value, setValue ] = useState('');\n\n    useEffect(() => {\n        (async function() {\n            if (!id) {\n                setInitState(true);\n                return;\n            };\n            logService.get(id)\n                .then(m => {\n                    m && setValue(m.content);\n                    setIsNew(false);\n                })\n                .finally(() => {\n                    setInitState(true);\n                });\n        })();\n    }, [ id ]);\n    return (\n        <AppFrame header={\n            <NormalNavigator showBack title=\"编辑日志\" actions={\n                <Button minimal intent=\"primary\" icon=\"confirm\" onClick={() => {\n                    let process;\n                    if (isNew) {\n                        process = logService.add({\n                            content: value\n                        });\n                    } else {\n                        process = logService.upd(id, {\n                            content: value\n                        });\n                    }\n                    process.then(() => {\n                        h.goBack();\n                    }).catch(err => {\n                        AppToaster.show({ timeout: 2000, message: err.message, intent: 'error' });\n                    });\n                }}>提交</Button>\n            } />\n        }>\n            <div className={styles.container}>\n                {\n                    initState && <LogEditor\n                        value={value}\n                        onChange={val => setValue(val)}\n                        placeholder=\"请由此开始...\"\n                    />\n                }\n            </div>\n        </AppFrame>\n    );\n}\n\nexport const component = LogCreate;\nexport const path = '/log.createOrEdit/:id?';","import React from 'react';\nimport { Card, TextArea } from '@blueprintjs/core';\nimport styles from './index.module.css';\nimport { noop } from 'util/commonUtil';\n\nexport default function LogCommentEditor (props) {\n    const { value = '', onChange = noop, placeholder = '' } = props;\n\n    return (\n        <div className={styles.container}>\n            <Card>\n                <TextArea\n                    fill\n                    large\n                    autoFocus\n                    value={value}\n                    growVertically\n                    placeholder={placeholder}\n                    onChange={evt => onChange(evt.target.value)}\n                />\n            </Card>\n        </div>\n    );\n}","import React, { useState, useEffect} from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Button } from '@blueprintjs/core';\nimport styles from './logCommentCreate.module.css';\nimport LogCommentEditor from 'component/logCommentEditor';\nimport AppFrame from 'component/appFrame';\nimport NormalNavigation from 'component/normalNavigator';\nimport logCommentService from 'service/logComment';\n\nfunction LogCommentCreate() {\n    const params = useParams();\n    const { id = null, cid = null } = params;\n    const [ initState, setInitState ] = useState(false);\n    const [ isNew, setIsNew ] = useState(true);\n    const [ value, setValue ] = useState('');\n    const h = useHistory();\n\n    useEffect(() => {\n        (async function() {\n            if (!cid) {\n                setInitState(true);\n                return;\n            };\n            logCommentService.get(cid)\n                .then(m => {\n                    m && setValue(m.content);\n                    setIsNew(false);\n                })\n                .finally(() => {\n                    setInitState(true);\n                });\n        })();\n    }, [ cid ]);\n    return (\n        <AppFrame header={\n            <NormalNavigation showBack title=\"编辑日志评论\" actions={\n                <Button minimal icon=\"confirm\" intent=\"primary\" onClick={() => {\n                    let process;\n                    if (isNew) {\n                        process = logCommentService.add(id, {\n                            time: new Date(),\n                            content: value\n                        });\n                    } else {\n                        process = logCommentService.upd(cid, {\n                            content: value\n                        });\n                    }\n                    process.then(() => {\n                        h.goBack();\n                    }).catch(err => {\n                        alert(err.message);\n                    });\n                }}>提交</Button>\n            } />\n        }>\n            <div className={styles.container}>\n                {\n                    initState && <LogCommentEditor\n                        value={value}\n                        onChange={val => setValue(val)}\n                        placeholder=\"请从此出开始...\"\n                    />\n                }\n            </div>\n        </AppFrame>\n    );\n}\n\nexport const component = LogCommentCreate;\nexport const path = '/log.comment.createOrEdit/:id/:cid?';","/* eslint-disable jsx-a11y/anchor-is-valid  */\n\nimport React, { useState } from 'react';\nimport TimeAgo from 'timeago-react';\nimport { useHistory } from 'react-router-dom';\nimport { Card, Classes, Alert, Intent, Elevation } from '@blueprintjs/core';\nimport names from 'classnames';\nimport styles from './index.module.css';\nimport MarkdownPreview from 'component/markdownPreview';\nimport { AppToaster } from 'util/toaster';\nimport logService from 'service/log';\n\nexport default function (props) {\n    const h = useHistory();\n    const [ visible, setVisible ] = useState(true);\n    const [ isOpen, setIsOpen ] = useState(false);\n    return (\n        visible && <div className={styles.container}>\n            <Alert\n                cancelButtonText=\"取消\"\n                confirmButtonText=\"确定删除\"\n                icon=\"trash\"\n                intent={Intent.DANGER}\n                isOpen={isOpen}\n                onCancel={() => setIsOpen(false)}\n                onConfirm={() => {\n                    setIsOpen(false);\n                    logService.del(props.id)\n                        .then(() => {\n                            setVisible(false);\n                            AppToaster.show({ timeout: 2000, message: '删除成功', intent: 'success' });\n                        })\n                        .catch(err => {\n                            alert(err.message);\n                        });\n                }}\n            >\n                你确定将此条记录删除吗？ 删除后无法再次找回，请确认操作。\n            </Alert>\n            <div className={styles.meta}>\n                <span className={names(Classes.TEXT_MUTED, Classes.TEXT_SMALL)}>\n                    <TimeAgo datetime={props.date} locale='zh_CN' />\n                </span>\n            </div>\n            <Card elevation={Elevation.ONE} interactive onClick={() => h.push(`/log.detail/${props.id}`)}>\n                <div className={names(\"markdown-body\", styles.markdownBody)}>\n                    <MarkdownPreview source={props.children} short />\n                </div>\n            </Card>\n        </div>\n    );\n}","import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { Button } from '@blueprintjs/core';\nimport styles from './log.module.css';\nimport LogItem from 'component/logItem';\nimport AppFrame from 'component/appFrame';\nimport logService from 'service/log';\nimport NormalNavigator from 'component/normalNavigator';\n\n\nfunction Log() {\n    const h = useHistory();\n    const [logs, setlogs] = useState([]);\n    useEffect(() => {\n        async function fetch() {\n            const list = await logService.all();\n            setlogs(list);\n        }\n        fetch();\n    }, []);\n    return (\n        <AppFrame header={\n            <NormalNavigator title=\"英雄·日志\" actions={\n                <Button\n                    minimal intent=\"primary\" icon=\"annotation\"\n                    onClick={() => h.push('/log.createOrEdit')}\n                >创建日志</Button>\n            } />\n        }>\n            <div className={styles.container}>\n                {\n                    logs.map(message => (\n                        <LogItem\n                            key={message.id}\n                            id={message.id}\n                            date={message.time}\n                        >{message.content}</LogItem>\n                    ))\n                }\n            </div>\n        </AppFrame>\n    );\n}\n\nexport const component = Log;\nexport const path = '/log';\nexport const exact = true;","import React from 'react';\nimport styles from './index.module.css';\n\nexport default function(props) {\n    return (\n        <div className={styles.container}>\n            { props.header && <div className={styles.header}>{props.header}</div> }\n            <div className={styles.body}>{props.children}</div>\n            { props.footer && <div className={styles.footer}>{props.footer}</div> }\n        </div>\n    );\n}","\nimport React from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n    Navbar, NavbarGroup, Button, NavbarHeading, NavbarDivider\n} from '@blueprintjs/core';\n\nexport default function NormalNavigator(props) {\n    const { showBack = false, title = '', actions = [] } = props;\n    const h = useHistory();\n    return (\n        <Navbar style={{ userSelect: 'none'}}>\n            <div style={{width: '640px', margin: 'auto'}}>\n                <NavbarGroup align=\"left\">\n                    {\n                        showBack && <>\n                            <Button\n                                onClick={() => h.goBack()}\n                                icon=\"chevron-left\"\n                                minimal\n                            >返回</Button>\n                            <NavbarDivider />\n                        </>\n                    }\n                    {\n                        title !== '' && <NavbarHeading>{title}</NavbarHeading>\n                    }\n                </NavbarGroup>\n                <NavbarGroup align=\"right\">\n                    {actions}\n                </NavbarGroup>\n            </div>\n        </Navbar>\n    );\n}","import { Position, Toaster } from \"@blueprintjs/core\";\n \n\nexport const AppToaster = Toaster.create({\n    className: \"recipe-toaster\",\n    position: Position.TOP\n});","\nexport const noop = () => false;","import store from 'store/index';\n\nconst get = (id) => store.logComments.get(Number(id));\n\nconst add = (id, logCommentInfo) => store.logComments.add({...logCommentInfo, lid: id});\n\nconst del = (id) => store.logComments.delete(Number(id));\n\nconst upd = (id, logCommentInfo) => store.logComments.update(Number(id), logCommentInfo);\n\nconst all = (id) => store.logComments.where({ lid: id }).toArray();\n\nexport default {\n    get, add, del, upd, all\n}","import React from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport names from 'classnames';\nimport styles from './index.module.css';\n\nconst SEGMENT = '---\\n';\n\nfunction findTopLevelEle(target) {\n    if (!(target instanceof HTMLElement)) return null;\n    if (!(target.parentNode instanceof HTMLElement)) return null;\n    const pnode = target.parentElement;\n    if (pnode.classList.contains(styles.markdownBody)) {\n        return target;\n    }\n    return findTopLevelEle(pnode);\n}\nfunction generatLinks(source) {\n    return source.replace(/#(\\w{1,100})\\s/g, (_, p1) => `[${p1}](#/alia/${p1})`);\n}\n\nexport default function MarkdownPreview(props) {\n    const { source: rsource = '', className, selectAble = false } = props;\n    const source = generatLinks(rsource);\n    const sepIdx = source.indexOf(SEGMENT);\n    const title = sepIdx > 0 ? source.slice(0, sepIdx) : '';\n    return (\n        <div\n            className={names(\n                \"markdown-body\",\n                className,\n                styles.markdownBody,\n                selectAble ? styles.active : ''\n            )}\n            onClick={evt => {\n                if (!props.selectAble || typeof props.onSelect !== 'function') return;\n                const el = findTopLevelEle(evt.target);\n                const sourcePosStr = el.getAttribute('data-sourcePos');\n                props.onSelect(sourcePosStr);\n            }}\n        >\n            <ReactMarkdown\n                source={props.short ? (title || source) : source}\n                sourcePos={selectAble}\n            />\n        </div>\n    );\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"logDetail_container__w0WFV\",\"logContentBox\":\"logDetail_logContentBox__2FBOS\",\"logContent\":\"logDetail_logContent__2q741\",\"commentBox\":\"logDetail_commentBox__2xmER\",\"commentContent\":\"logDetail_commentContent__2yOe-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"appFrame_container__28Uto\",\"header\":\"appFrame_header__VXnlL\",\"body\":\"appFrame_body__1wP9K\",\"footer\":\"appFrame_footer__PUQHy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"logItem_container__1HQ_G\",\"metaBlock\":\"logItem_metaBlock__19X2m\",\"meta\":\"logItem_meta__JAOjF\",\"metaItem\":\"logItem_metaItem__37psE\",\"markdownBody\":\"logItem_markdownBody__1O-pH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"markdownBody\":\"markdownPreview_markdownBody__3D-P7\"};","import React from 'react';\nimport { Route } from 'react-router-dom';\n\nconst routes = [];\nconst pageCtx = require.context('.', false, /\\.js$/);\n\npageCtx.keys().forEach(key => {\n    if (key === './index.js') return;\n    const route = pageCtx(key);\n    routes.push(<Route {...route} key={key} />);\n});\n\nexport default routes;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"markdownEditor_container__1Bh7Q\",\"editorBox\":\"markdownEditor_editorBox__2jfkZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"alia_container__3sOFO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"log_container__1snyH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"logCommentCreate_container__3qGs1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"textarea\":\"logCommentEditor_textarea__ltzcQ\",\"container\":\"logCommentEditor_container__3s0iH\",\"buttonWrap\":\"logCommentEditor_buttonWrap__o5tot\"};"],"sourceRoot":""}